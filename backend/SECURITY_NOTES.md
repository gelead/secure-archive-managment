# Security Implementation Notes

## Secure Password Transmission

**HTTPS/TLS Required**: All password transmission must occur over HTTPS (TLS 1.2 or higher) to prevent interception.

### Implementation:
- Passwords are never transmitted in plain text
- All API endpoints should be served over HTTPS in production
- Use environment variable `HTTPS_ENABLED=true` to enforce HTTPS-only connections
- Passwords are hashed server-side using bcrypt with salt (prevents rainbow table attacks)

### Password Hashing:
- Algorithm: bcrypt with 12 rounds (automatically includes unique salt per password)
- Salt: Automatically generated by bcrypt (stored as part of hash)
- Protection: Each password hash is unique, preventing rainbow table attacks

## Session Management

### Token-Based Authentication:
- Access tokens: JWT with 15-minute expiration
- Refresh tokens: Cryptographically secure random tokens (32 bytes)
- Session tracking: Server-side session management with IP, user agent, location, and device tracking

### Session Security:
- Sessions expire after 24 hours of inactivity
- Sessions can be revoked by user or admin
- Session data includes IP address and user agent for anomaly detection

## Multi-Factor Authentication (MFA)

### Supported Methods:
1. **TOTP (Time-based One-Time Password)**: Using speakeasy library
   - 6-digit codes, 30-second time windows
   - Compatible with Google Authenticator, Authy, etc.

2. **OTP via SMS/Email**: 6-digit codes sent to registered phone/email
   - Codes expire after 10 minutes
   - Single-use codes

3. **Biometric Authentication** (Structure in place):
   - WebAuthn API support structure
   - TouchID/FaceID support (device-specific)
   - Fingerprint/face recognition (requires device APIs)

## Access Control Models

### MAC (Mandatory Access Control):
- System-enforced policies (users cannot grant access)
- Only system administrators can modify access policies
- Access determined by clearance levels vs. data classification

### DAC (Discretionary Access Control):
- Resource owners control sharing
- File-level and record-level permissions
- Detailed permission logs tracking all grants/revocations

### RBAC (Role-Based Access Control):
- Role-based permissions with audit trail
- Dynamic role assignment with approval workflow
- Role change requests tracked

### RuBAC (Rule-Based Access Control):
- Time-based rules (working hours: 9 AM - 5 PM, Mon-Fri)
- Location-based restrictions
- Device-based restrictions
- Conditional business rules (e.g., HR Managers approve leave > 10 days)

### ABAC (Attribute-Based Access Control):
- Policy Decision Point (PDP) for real-time evaluation
- Multi-attribute evaluation (role + department + time + location)
- Fine-grained access control based on user and resource attributes

## Audit Trails and Logging

### Log Encryption:
- All logs encrypted at rest using AES-256-CBC
- Encryption key stored in environment variable `LOG_KEY`
- Logs include: timestamp, user ID, username, action, IP address, status

### Centralized Logging:
- All logs aggregated in `backend/logs/centralized.log`
- Database persistence for MongoDB connections
- Log retention and rotation policies

### Alerting:
- Brute force attack detection
- Suspicious access pattern detection
- Anomaly detection (after-hours access, rapid role changes)
- Account lockout alerts
- Configuration change alerts

## Data Backups

### Automated Backups:
- Scheduled backups every 60 minutes (configurable)
- Backup includes: data files, logs, database snapshots
- Backup manifest with metadata
- Automatic cleanup of old backups (keeps last 10)

### Backup Security:
- Backups stored in `backend/backups/` directory
- Each backup is timestamped and isolated
- Backup integrity verified via manifest files

## Account Security

### Password Policies:
- Minimum length: 10 characters
- Must include: uppercase, lowercase, digit, special character
- Password change requires old password verification
- New passwords must meet policy requirements

### Account Lockout:
- 5 failed login attempts trigger lockout
- Lockout duration: 5 minutes
- Automatic unlock after lockout period
- Alerts generated on account lockout

## User Registration and Verification

### Email/Phone Verification:
- Verification codes sent on registration
- Codes expire after 10 minutes
- Single-use verification codes
- Users can update verification status

### CAPTCHA:
- Required during registration
- Prevents bot account creation
- User-friendly implementation (checkbox-based for demo)

## User Profiles

### Profile Management:
- Secure profile updates (authenticated users only)
- Profile fields: firstName, lastName, bio, avatar
- Profile update audit trail

## Compliance Notes

- All sensitive operations logged with IP addresses
- Access control changes restricted to administrators
- Permission changes tracked in audit logs
- Session management for compliance tracking
- Encrypted log storage for sensitive information protection

